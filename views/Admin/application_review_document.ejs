<% layout('./Layout/layout.ejs') -%>

    <div class="row">
        <div class="col-12">
            <div class="page-title-box justify-content-between d-flex align-items-md-center flex-md-row flex-column">
                <h4 class="page-title">
                    <%=pagetitle%>
                </h4>
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="/admin/dashboard">Dashboard</a></li>
                    <li class="breadcrumb-item"><a href="/admin/applications/review">Applications Review</a></li>
                    <li class="breadcrumb-item active">Current</li>
                </ol>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <div class="applicationForm">
                         <div class="applicationForm">
                            <h4>I. Personal Information</h4>

                            <!-- Name Field -->
                            <div class="mb-3">
                                <label for="name" class="form-label">Name (Last Name, First Name, Middle Name)</label>
                                <input type="text" class="form-control" id="name" readonly name="name" required
                                    value="<%= application.name %>">
                            </div>
                            <div class="row">
                                <div class="col-lg-6"> <!-- Address Field -->
                                    <div class="mb-3">
                                        <label for="address" class="form-label">Address</label>
                                        <input type="text" class="form-control" id="address" readonly name="address"
                                            required value="<%= application.address %>">
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Zip Code Field -->
                                    <div class="mb-3">
                                        <label for="zip_code" class="form-label">Zip Code</label>
                                        <input type="text" class="form-control" id="zip_code" readonly name="zip_code"
                                            value="<%= application.zip_code %>">
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Phonenumber and Email Fields -->
                                    <div class="mb-3">
                                        <label for="phonenumber" class="form-label">Phone Number(s)</label>
                                        <input type="text" class="form-control" id="phonenumber" readonly
                                            name="phonenumber" required value="<%= application.phonenumber %>">
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="mb-3">
                                        <label for="email" class="form-label">Email</label>
                                        <input type="email" class="form-control" id="email" readonly name="email"
                                            required value="<%= application.email %>">
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Birth Date Field -->
                                    <div class="mb-3">
                                        <label for="birth_date" class="form-label">Birth Date</label>


                                        <input type="date" class="form-control" id="birth_date" readonly
                                            name="birth_date" required
                                            value="<%= new Date(application.birth_date).toLocaleDateString('en-CA') %>">

                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Birthplace Field -->
                                    <div class="mb-3">
                                        <label for="birthplace" class="form-label">Birthplace</label>
                                        <input type="text" class="form-control" id="birthplace" readonly
                                            name="birthplace" required value="<%= application.birthplace %>">
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Civil Status Field -->
                                    <div class="mb-3">
                                        <label for="civil_status" class="form-label">Civil Status</label>
                                        <select class="form-select" id="civil_status" readonly name="civil_status"
                                            required>
                                            <option value="" selected disabled>Select Status</option>
                                            <option value="Single" <%=application.civil_status==='Single' ? 'selected'
                                                : '' %>>Single</option>
                                            <option value="Married" <%=application.civil_status==='Married' ? 'selected'
                                                : '' %>>Married</option>
                                            <option value="Separated" <%=application.civil_status==='Separated'
                                                ? 'selected' : '' %>>Separated</option>
                                            <option value="Widowed" <%=application.civil_status==='Widowed' ? 'selected'
                                                : '' %>>Widowed</option>
                                            <option value="Divorced" <%=application.civil_status==='Divorced'
                                                ? 'selected' : '' %>>Divorced</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Sex Field -->
                                    <div class="mb-3">
                                        <label for="sex" class="form-label">Sex</label>
                                        <select class="form-select" id="sex" readonly name="sex" required>
                                            <option value="" hidden>Choose...</option>
                                            <option value="male" <%=application.sex==='male' ? 'selected' : '' %>>Male
                                            </option>
                                            <option value="female" <%=application.sex==='female' ? 'selected' : '' %>
                                                >Female</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Nationality Field -->
                                    <div class="mb-3">
                                        <label for="nationality" class="form-label">Nationality</label>
                                        <input type="text" class="form-control" id="nationality" readonly
                                            name="nationality" value="<%= application.nationality || 'Filipino' %>"
                                            >
                                    </div>
                                </div>
                                <div class="col-lg-6"> <!-- Languages Spoken Field -->
                                    <div class="mb-3">
                                        <label for="languages" class="form-label">Languages and Dialects Spoken</label>
                                        <input type="text" class="form-control" id="languages" readonly name="languages"
                                             value="<%= application.languages %>">
                                    </div>
                                </div>
                            </div>

                            <!-- Learning Objectives -->
                            <h4>Learning Objectives</h4>

                            <div class="mb-3">
                                <label for="first_priority" class="form-label">First Priority Degree Program</label>
                                <select class="form-control" id="first_priority" name="first_priority">
                                    <option value="" hidden selected>Choose Program</option>
                                    <option value="Civil/Drafting Technology"
                                        <%=application.first_priority==='Civil/Drafting Technology' ? 'selected' : '' %>
                                        >Civil/Drafting Technology</option>
                                    <option value="Computer Technology"
                                        <%=application.first_priority==='Computer Technology' ? 'selected' : '' %>
                                        >Computer Technology</option>
                                    <option value="Electronics Technology"
                                        <%=application.first_priority==='Electronics Technology' ? 'selected' : '' %>
                                        >Electronics Technology</option>
                                    <option value="Electrical Technology"
                                        <%=application.first_priority==='Electrical Technology' ? 'selected' : '' %>
                                        >Electrical Technology</option>
                                    <option value="Food Technology" <%=application.first_priority==='Food Technology'
                                        ? 'selected' : '' %>>Food Technology</option>
                                    <option value="Garments Technology"
                                        <%=application.first_priority==='Garments Technology' ? 'selected' : '' %>
                                        >Garments Technology</option>
                                    <option value="Refrigeration and Air-con Technology"
                                        <%=application.first_priority==='Refrigeration and Air-con Technology'
                                        ? 'selected' : '' %>>Refrigeration and Air-con Technology</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="second_priority" class="form-label">Second Priority Degree Program</label>
                                <select class="form-control" id="second_priority" name="second_priority">
                                    <option value="" hidden selected>Choose Program</option>
                                    <option value="Civil/Drafting Technology"
                                        <%=application.second_priority==='Civil/Drafting Technology' ? 'selected' : ''
                                        %>>Civil/Drafting Technology</option>
                                    <option value="Computer Technology"
                                        <%=application.second_priority==='Computer Technology' ? 'selected' : '' %>
                                        >Computer Technology</option>
                                    <option value="Electronics Technology"
                                        <%=application.second_priority==='Electronics Technology' ? 'selected' : '' %>
                                        >Electronics Technology</option>
                                    <option value="Electrical Technology"
                                        <%=application.second_priority==='Electrical Technology' ? 'selected' : '' %>
                                        >Electrical Technology</option>
                                    <option value="Food Technology" <%=application.second_priority==='Food Technology'
                                        ? 'selected' : '' %>>Food Technology</option>
                                    <option value="Garments Technology"
                                        <%=application.second_priority==='Garments Technology' ? 'selected' : '' %>
                                        >Garments Technology</option>
                                    <option value="Refrigeration and Air-con Technology"
                                        <%=application.second_priority==='Refrigeration and Air-con Technology'
                                        ? 'selected' : '' %>>Refrigeration and Air-con Technology</option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <label for="third_priority" class="form-label">Third Priority Degree Program</label>
                                <select class="form-control" id="third_priority" name="third_priority">
                                    <option value="" hidden selected>Choose Program</option>
                                    <option value="Civil/Drafting Technology"
                                        <%=application.third_priority==='Civil/Drafting Technology' ? 'selected' : '' %>
                                        >Civil/Drafting Technology</option>
                                    <option value="Computer Technology"
                                        <%=application.third_priority==='Computer Technology' ? 'selected' : '' %>
                                        >Computer Technology</option>
                                    <option value="Electronics Technology"
                                        <%=application.third_priority==='Electronics Technology' ? 'selected' : '' %>
                                        >Electronics Technology</option>
                                    <option value="Electrical Technology"
                                        <%=application.third_priority==='Electrical Technology' ? 'selected' : '' %>
                                        >Electrical Technology</option>
                                    <option value="Food Technology" <%=application.third_priority==='Food Technology'
                                        ? 'selected' : '' %>>Food Technology</option>
                                    <option value="Garments Technology"
                                        <%=application.third_priority==='Garments Technology' ? 'selected' : '' %>
                                        >Garments Technology</option>
                                    <option value="Refrigeration and Air-con Technology"
                                        <%=application.third_priority==='Refrigeration and Air-con Technology'
                                        ? 'selected' : '' %>>Refrigeration and Air-con Technology</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="cost_accreditation" class="form-label">Who will pay for the cost of
                                    obtaining your accreditation?</label>
                                <input readonly class="form-control" id="cost_accreditation" name="cost_accreditation"
                                    value="<%= application.cost_accreditation || '' %>">
                            </div>

                            <div class="mb-3">
                                <label for="time_commitment" class="form-label">How soon do you need to complete
                                    accreditation/equivalency?</label>
                                <input readonly class="form-control" id="time_commitment" name="time_commitment"
                                    value="<%= application.time_commitment || '' %>">
                            </div>
                            <!-- Lifelong Learning Experiences -->
                            <h4>II. Lifelong Learning Experiences</h4>

                            <div class="mb-3">
                                <label for="hobbies_leisure" class="form-label">A. Hobbies/Leisure Activities</label>
                                <br><small>Include only those leisure activities which can be considered learning
                                    opportunities.</small>
                                <textarea readonly class="form-control" id="hobbies_leisure" name="hobbies_leisure"
                                    rows="5"><%= application.hobbies_leisure || '' %></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="special_skills" class="form-label">B. Special Skills</label>
                                <br><small>A special skill can be considered as an acceptable substitute for a specific
                                    credit requirement. Note down those special skills which you think must be related
                                    to the field of study you want to pursue.</small>
                                <textarea readonly class="form-control" id="special_skills" name="special_skills"
                                    rows="5"><%= application.special_skills || '' %></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="work_related_activities" class="form-label">C. Work-Related
                                    Activities</label>
                                <br><small>Some work-related activities are occasions for you to learn something new.
                                    Identify those tasks that can be considered as new and through which you learned new
                                    skills and knowledge. Please do not include, under this category, formal training.
                                    However, you may include here experiences which can be classified as
                                    on-the-job-training or apprenticeship.</small>
                                <textarea readonly class="form-control" id="work_related_activities"
                                    name="work_related_activities"
                                    rows="5"><%= application.work_related_activities || '' %></textarea>
                            </div>

                            <div class="mb-3">
                                <label for="volunteer_activities" class="form-label">D. Volunteer Activities</label>
                                <br><small>Choose only volunteer activities that also demonstrate learning
                                    opportunities.</small>
                                <textarea readonly class="form-control" id="volunteer_activities" name="volunteer_activities"
                                    rows="5"><%= application.volunteer_activities || '' %></textarea>
                            </div>

                            <!-- Education -->
                            <h4>III. Education</h4>
                            <!-- Educational Qualifications -->
                            <h6>A. Educational Qualifications</h6>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Educational Qualification</th>
                                        <th>Name of School</th>
                                        <th>Address</th>
                                        <th>Date First Attended</th>
                                        <th>Date Last Attended</th>
                                        <th>Copy of TOR/Form 137</th>
                             
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><%=application.qualification%></td> <!-- Replace with the actual qualification level -->
                                        <td>
                                            <%= application.school_name || 'N/A' %>
                                        </td>
                                        <td>
                                            <%= application.school_address || 'N/A' %>
                                        </td>
                                        <td>
                                            <%= application.date_first_attended ? new
                                                Date(application.date_first_attended).toLocaleDateString('en-CA')
                                                : 'N/A' %>
                                        </td>
                                        <td>
                                            <%= application.date_last_attended ? new
                                                Date(application.date_last_attended).toLocaleDateString('en-CA') : 'N/A'
                                                %>
                                        </td>
                                        <td class="align-middle">
                                            <% if (application.tor_file) { %>
                                                <div>
                                                   
                                                    <a href="/uploads/<%= application.tor_file %>"
                                                        class="btn btn-sm btn-primary"> 
                                                        <i class="ri-eye-line me-1"></i>View
                                                   
                                                    </a>
                                                   
                                                        <a href="/uploads/<%= application.tor_file %>"
                                                            class="btn btn-sm btn-primary" download>
                                                            <i class="ri-download-line"></i> Download
                                                        </a>
                                                 
                                                </div>
                                                <% } else { %>
                                                    <span class="text-muted">No document uploaded.</span>
                                                    <% } %>
                                        </td>
                                   

                                    </tr>
                                    <!-- Additional rows for more educational qualifications can be added here -->
                                </tbody>
                            </table>


                            <h4>IV. Work Experiences</h4>


                            <div id="ordinary_employee_fields" class="input-fields">

                                <table class="table table-bordered">
                                    <thead>
                                        <tr>
                                            <th>Position/Job Title</th>
                                            <th>Company Name</th>
                                            <th>Address</th>
                                            <th>Date Started and Ended</th>

                                            <th>Copy of Certificate of Enrollment</th>
                                  
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% if (workExperience && workExperience.length> 0) { %>
                                            <% workExperience.forEach(function(emp) { %>
                                                <tr>
                                                    <td>
                                                        <%= emp.job_title || 'Ordinary Employee' %>
                                                            <!-- Display job title -->
                                                    </td>
                                                    <td>
                                                        <%= emp.company_name || '' %> <!-- Display company name -->
                                                    </td>
                                                    <td>
                                                        <%= emp.company_address || '' %>
                                                            <!-- Display company address -->
                                                    </td>

                                                    <td>
                                                        <%= emp.date_started_end || '' %> <!-- Display end date -->
                                                    </td>
                                                    <td>
                                                        <% if (emp.employment_file) { %>
                                                            <!-- Check if there is a file -->
                                                            <a href="/uploads/<%= emp.employment_file %>"
                                                                class="btn btn-sm btn-primary">
                                                                <i class="ri-eye-line me-1"></i>View
                                                            </a>
                                                            <a href="/uploads/<%= emp.employment_file %>"
                                                                class="btn btn-sm btn-primary" download>
                                                                <i class="ri-download-line"></i> Download
                                                            </a>
                                                            <% } else { %>
                                                                No file uploaded
                                                                <% } %>
                                                    </td>
                                               
                                                </tr>
                                                <% }) %>
                                                    <% } else { %>
                                                        <tr>
                                                            <td colspan="6">No employment records available.</td>
                                                        </tr>
                                                        <% } %>

                                    </tbody>
                                </table>

                            </div>

                            <h4>V. PROFESSIONAL ACHIEVEMENTS</h4>

                            <!-- Level of Training/Seminar -->
                            <h6>A. Trainings and Seminars</h6>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Level</th>
                                        <th>Title of Training/Seminar</th>
                                        <th>Sponsoring Organization</th>
                                        <th>Inclusive Date</th>
                                        <th>Copy of Certificate</th>
                           
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (trainingExperience && trainingExperience.length> 0) { %>
                                        <% trainingExperience.forEach(function(training) { %>
                                            <tr>
                                                <td>
                                                    <%= training.training_level || 'N/A' %>
                                                </td>
                                                <td>
                                                    <%= training.training_title || 'N/A' %>
                                                </td>
                                                <td>
                                                    <%= training.training_sponsor || 'N/A' %>
                                                </td>
                                                <td>
                                                    <%= training.training_date || 'N/A' %>
                                                </td>
                                                <td>
                                                    <% if (training.training_certificate) { %>
                                                        <a href="/uploads/<%= training.training_certificate %>"
                                                            class="btn btn-sm btn-primary">
                                                            <i class="ri-eye-line me-1"></i> View
                                                        </a>
                                                        <a href="/uploads/<%= training.training_certificate %>"
                                                            class="btn btn-sm btn-primary" download>
                                                            <i class="ri-download-line"></i> Download
                                                        </a>
                                                        <% } else { %>
                                                            No certificate available
                                                            <% } %>
                                                </td>
                                            
                                            </tr>
                                            <% }) %>
                                                <% } else { %>
                                                    <tr>
                                                        <td colspan="5">No training records available.</td>
                                                    </tr>
                                                    <% } %>
                                </tbody>
                            </table>


                            <!-- Professional Development -->
                            <h6>B. Professional Development</h6>
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Level</th>
                                        <th>Organization</th>
                                        <th>Description</th>
                                        <th>Certificate File</th>
                                      
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (professionalDevelopments && professionalDevelopments.length> 0) { %>
                                        <% professionalDevelopments.forEach(function(dev) { %>
                                            <tr>
                                                <td>
                                                    <%= dev.professional_dev_level || 'N/A' %>
                                                </td>
                                                <td>
                                                    <%= dev.organization_dev || 'N/A' %>
                                                </td>
                                                <td>
                                                    <%= dev.description_dev || 'N/A' %>
                                                </td>
                                                <td>
                                                    <% if (dev.certificate_file_dev) { %>
                                                        <a href="/uploads/<%= dev.certificate_file_dev %>"
                                                            class="btn btn-sm btn-primary">
                                                            <i class="ri-eye-line me-1"></i> View
                                                        </a>
                                                        <a href="/uploads/<%= dev.certificate_file_dev %>"
                                                            class="btn btn-sm btn-primary" download>
                                                            <i class="ri-download-line"></i> Download
                                                        </a>
                                                        <% } else { %>
                                                            No certificate available
                                                            <% } %>
                                                </td>
                                             
                                            </tr>
                                            <% }) %>
                                                <% } else { %>
                                                    <tr>
                                                        <td colspan="4">No professional development records available.
                                                        </td>
                                                    </tr>
                                                    <% } %>
                                </tbody>
                            </table>


                            <h6>C. Eligibilities/Awards</h6>

                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Eligibility Level</th>
                                        <th>Copy of Certificate</th>
                                  
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Sub-Professional Eligibility -->
                                    <% if(application.certificate_file_sub_professional) { %>
                                        <tr>
                                            <td>CSC Sub-Professional</td>
                                            <td>
                                                <a href="/uploads/<%= application.certificate_file_sub_professional %>" class="btn btn-sm btn-primary">
                                                    <i class="ri-eye-line me-1"></i>View
                                                </a>
                                                <a href="/uploads/<%= application.certificate_file_sub_professional %>" class="btn btn-sm btn-primary" download>
                                                    <i class="ri-download-line"></i> Download
                                                </a>
                                            </td>
                                     
                                        </tr>
                                    <% } %>
                            
                                    <!-- Technical (NC) Eligibility -->
                                    <% if(application.certificate_file_technical_nc) { %>
                                        <tr>
                                            <td>Technical (NC)</td>
                                            <td>
                                                <a href="/uploads/<%= application.certificate_file_technical_nc %>" class="btn btn-sm btn-primary">
                                                    <i class="ri-eye-line me-1"></i>View
                                                </a>
                                                <a href="/uploads/<%= application.certificate_file_technical_nc %>" class="btn btn-sm btn-primary" download>
                                                    <i class="ri-download-line"></i> Download
                                                </a>
                                            </td>
                                         
                                        </tr>
                                    <% } %>
                            
                                    <!-- Professional (PRC) (CSC) Eligibility -->
                                    <% if(application.certificate_file_professional_prc_csc) { %>
                                        <tr>
                                            <td>Professional (PRC) (CSC)</td>
                                            <td>
                                                <a href="/uploads/<%= application.certificate_file_professional_prc_csc %>" class="btn btn-sm btn-primary">
                                                    <i class="ri-eye-line me-1"></i>View
                                                </a>
                                                <a href="/uploads/<%= application.certificate_file_professional_prc_csc %>" class="btn btn-sm btn-primary" download>
                                                    <i class="ri-download-line"></i> Download
                                                </a>
                                            </td>
                                         
                                        </tr>
                                    <% } %>
                                </tbody>
                            </table>
                            
                            <table class="table table-bordered">
                                <thead>
                                    <tr>
                                        <th>Award Level</th>
                                        <th>Copy of Certificate File</th>
                                   
                                    </tr>
                                </thead>
                                <tbody>
                                    <% if (awards && awards.length > 0) { %>
                                        <% awards.forEach(function(award) { %>
                                            <tr>
                                                <td><%= award.award_level || 'N/A' %></td>
                                                <td>
                                                    <% if (award.certificate_file_award) { %>
                                                        <a href="/uploads/<%= award.certificate_file_award %>" class="btn btn-sm btn-primary">
                                                            <i class="ri-eye-line me-1"></i> View
                                                        </a>
                                                        <a href="/uploads/<%= award.certificate_file_award %>" class="btn btn-sm btn-primary" download>
                                                            <i class="ri-download-line"></i> Download
                                                        </a>
                                                    <% } else { %>
                                                        No certificate available
                                                    <% } %>
                                                </td>
                                            
                                            </tr>
                                        <% }) %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="3">No award records available.</td>
                                        </tr>
                                    <% } %>
                                </tbody>
                            </table>

                            <!-- Final Essay -->
                            <h4>VII. Final Essay</h4>
                            <div class="mb-3">
                                <label for="final_essay" class="form-label">If you finish your degree, how will this
                                    contribute to your personal development to the development of your community, your
                                    work place, society and country?</label>
                                <textarea readonly class="form-control" id="final_essay" readonly name="final_essay"
                                    rows="5"><%= application.final_essay %></textarea>
                            </div>


                            <!-- <button type="submit" class="btn btn-primary" id="submit-button"><span
                                    class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"
                                    style="display: none;"></span>Submit</button> -->
                        </div>
                        <hr>
                        <h4>Application Status Review</h4>
                        <form method="post" class="updateStatus">
                            <input type="hidden" name="id" value="<%= application.id %>">
                        
                            <div class="mb-3">
                                <label for="status" class="form-label">Status</label>
                                <select class="form-select" name="status" required>
                                    <option value="Rejected" <%= application.status === 'Rejected' ? 'selected' : '' %>>Rejected</option>
                                    <option value="Pending" <%= application.status === 'Pending' ? 'selected' : '' %>>Pending</option>
                                   
                                    <option value="Approved" <%= application.status === 'Approved' ? 'selected' : '' %>>Approved</option>
                                </select>
                            </div>
                        
                            <div class="mb-3">
                                <textarea class="form-control" name="comment" placeholder="Add a comment...(optional)" rows="3"></textarea>
                            </div>
                            
                        
                            <div>
                                <button type="submit" class="btn btn-primary" id="submit-button">
                                    <span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true" style="display: none;"></span>Update Status
                                </button>
                            </div>
                        </form>
                        
                        <div class="mb-3 mt-3">
                            <label for="existing_comments" class="form-label">Existing Comments</label>
                            <div id="existing_comments" class="card border-1 ">
                                <div class="card-body">
                                    <% if (comments && comments.length > 0) { %>
                                        <% comments.forEach(comment => { %>
                                            <div class="pb-2">
                                                <strong><%= comment.author %></strong><small class="text-muted ms-1"><%= new Date(comment.created_at).toLocaleString() %></small>
                                                <p class="mb-1"><%= comment.text %></p>
                                                
                                            </div>
                                        <% }); %>
                                    <% } else { %>
                                        <p class="text-center text-muted">No comments available.</p>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                        
                        



                    </div>
        

                </div>
            </div>
        </div>
    </div>

    <%block('script').append(`
    <script>
        (function () {
	"use strict";

	class DocumentUpload {
		static initValidation() {
			// Initialize jQuery validation
			jQuery(".updateStatus").validate({
				rules: {
					status: {
						required: true,
					},
                    comment: {
                        minlength: 10
                    }
				},
				messages: {
					status: {
						required: "Please a status",
                    },comment: {
                        minlength: "Comment must be at least 10 characters"
                    }
				},
				submitHandler: function (form) {
					const submitButton =
						document.getElementById("submit-button");
					const spinner =
						submitButton.querySelector(".spinner-border");

					// Show spinner and disable button
					spinner.style.display = "inline-block";
					submitButton.disabled = true;

					// Change button text to 'Uploading...'
					submitButton.innerHTML =
						'<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true"></span>Updating...';

					const formData = new FormData(form); // Collect form data
					// Show loader or header loader (custom logic can be added here)

					// Send the FormData directly
					fetch("/admin/applications/review/", {
						method: "POST",
						body: formData, // Send FormData containing file
					})
						.then((response) => response.json())
						.then((data) => {
							spinner.style.display = "none";
							submitButton.disabled = false;
							submitButton.innerHTML =
								'<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true" style="display: none;"></span>Update';
							// Hide loader or header loader (custom logic can be added here)
							if (data.success) {
								// Reset the form

								$.notify(
									{
										icon: "fa fa-check me-1",
										message: data.message,
									},
									{
										type: "success",
										allow_dismiss: false,
									}
								);

								// Delay the reload to allow the notification to be seen
								setTimeout(() => {
									window.location.reload(); // Reload the current page
								}, 1800); // Adjust delay as needed
							} else {
								$.notify(
									{
										icon: "fa fa-times-circle me-1",
										message: data.message,
									},
									{
										type: "danger",
										allow_dismiss: false,
									}
								);
							}
						})
						.catch((error) => {
							spinner.style.display = "none";
							submitButton.disabled = false;
							submitButton.innerHTML =
								'<span class="spinner-border spinner-border-sm me-1" role="status" aria-hidden="true" style="display: none;"></span>Update';
							// Hide loader or header loader (custom logic can be added here)
							$.notify(
								{
									icon: "fa fa-times-circle me-1",
									message:
										"An error occurred. Please try again.",
								},
								{
									type: "danger",
									allow_dismiss: false,
								}
							);
							console.error("Error:", error);
						});
				},
			});
		}

		static init() {
			this.initValidation();
		}
	}

	// Call init function on document ready
	$(document).ready(() => DocumentUpload.init());
})();

    </script>
    <script>
        // Function to handle the form submission via AJAX
        document.querySelectorAll('form[id^="awardForm_"]').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();  // Prevent the default form submission
    
                var pointsValue = form.querySelector('input[type="number"]').value;  // Get the points value
                var awardId = form.querySelector('input[name="award_id"]').value;  // Get the award ID
                var formData = new FormData();
                formData.append('points', pointsValue);  // Append the points value to the form data
                formData.append('awardId', awardId);  // Append the award ID to the form data
                // Send the form data via Fetch API
                fetch('/admin/award/points/' + awardId, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())  // Parse the JSON response from the server
                .then(data => {
                    if (data.success) {
                        $.notify(
									{
										icon: "fa fa-check me-1",
										message: data.message,
									},
									{
										type: "success",
										allow_dismiss: false,
									}
								);
    
                    
                    } else {
                        $.notify(
									{
										icon: "fa fa-times-circle me-1",
										message: data.message,
									},
									{
										type: "danger",
										allow_dismiss: false,
									}
								);
                    }
                })
                .catch(error => {
               // Hide loader or header loader (custom logic can be added here)
							$.notify(
								{
									icon: "fa fa-times-circle me-1",
									message:
										"An error occurred. Please try again.",
								},
								{
									type: "danger",
									allow_dismiss: false,
								}
							);
							console.error("Error:", error);
                });
            });
        });


          // Function to handle the form submission via AJAX
          document.querySelectorAll('form[id^="empForm_"]').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();  // Prevent the default form submission
    
                var pointsValue = form.querySelector('input[type="number"]').value;  // Get the points value
                var empId = form.querySelector('input[name="emp_id"]').value;  // Get the award ID
                var formData = new FormData();
                formData.append('points', pointsValue);  // Append the points value to the form data
                formData.append('empId', empId);  // Append the award ID to the form data
                // Send the form data via Fetch API
                fetch('/admin/emp/points/' + empId, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())  // Parse the JSON response from the server
                .then(data => {
                    if (data.success) {
                        $.notify(
									{
										icon: "fa fa-check me-1",
										message: data.message,
									},
									{
										type: "success",
										allow_dismiss: false,
									}
								);
    
                    
                    } else {
                        $.notify(
									{
										icon: "fa fa-times-circle me-1",
										message: data.message,
									},
									{
										type: "danger",
										allow_dismiss: false,
									}
								);
                    }
                })
                .catch(error => {
               // Hide loader or header loader (custom logic can be added here)
							$.notify(
								{
									icon: "fa fa-times-circle me-1",
									message:
										"An error occurred. Please try again.",
								},
								{
									type: "danger",
									allow_dismiss: false,
								}
							);
							console.error("Error:", error);
                });
            });
        });
         // Function to handle the form submission via AJAX
         document.querySelectorAll('form[id^="trainingForm_"]').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();  // Prevent the default form submission
    
                var pointsValue = form.querySelector('input[type="number"]').value;  // Get the points value
                var trainingId = form.querySelector('input[name="training_id"]').value;  // Get the award ID
                var formData = new FormData();
                formData.append('points', pointsValue);  // Append the points value to the form data
                formData.append('trainingId', trainingId);  // Append the award ID to the form data
                // Send the form data via Fetch API
                fetch('/admin/training/points/' + trainingId, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())  // Parse the JSON response from the server
                .then(data => {
                    if (data.success) {
                        $.notify(
									{
										icon: "fa fa-check me-1",
										message: data.message,
									},
									{
										type: "success",
										allow_dismiss: false,
									}
								);
    
                    
                    } else {
                        $.notify(
									{
										icon: "fa fa-times-circle me-1",
										message: data.message,
									},
									{
										type: "danger",
										allow_dismiss: false,
									}
								);
                    }
                })
                .catch(error => {
               // Hide loader or header loader (custom logic can be added here)
							$.notify(
								{
									icon: "fa fa-times-circle me-1",
									message:
										"An error occurred. Please try again.",
								},
								{
									type: "danger",
									allow_dismiss: false,
								}
							);
							console.error("Error:", error);
                });
            });
        });


        // Function to handle the form submission via AJAX
        document.querySelectorAll('form[id^="devForm_"]').forEach(form => {
            form.addEventListener('submit', function(e) {
                e.preventDefault();  // Prevent the default form submission
    
                var pointsValue = form.querySelector('input[type="number"]').value;  // Get the points value
                var devId = form.querySelector('input[name="dev_id"]').value;  // Get the award ID
                var formData = new FormData();
                formData.append('points', pointsValue);  // Append the points value to the form data
                formData.append('devId', devId);  // Append the award ID to the form data
                // Send the form data via Fetch API
                fetch('/admin/development/points/' + devId, {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())  // Parse the JSON response from the server
                .then(data => {
                    if (data.success) {
                        $.notify(
									{
										icon: "fa fa-check me-1",
										message: data.message,
									},
									{
										type: "success",
										allow_dismiss: false,
									}
								);
    
                    
                    } else {
                        $.notify(
									{
										icon: "fa fa-times-circle me-1",
										message: data.message,
									},
									{
										type: "danger",
										allow_dismiss: false,
									}
								);
                    }
                })
                .catch(error => {
               // Hide loader or header loader (custom logic can be added here)
							$.notify(
								{
									icon: "fa fa-times-circle me-1",
									message:
										"An error occurred. Please try again.",
								},
								{
									type: "danger",
									allow_dismiss: false,
								}
							);
							console.error("Error:", error);
                });
            });
        });

// Select all forms that start with 'points-form' ID
document.querySelectorAll('form[id^="points-form"]').forEach(form => {
    form.addEventListener('submit', function(e) {
        e.preventDefault();  // Prevent the default form submission

        const pointsValue = form.querySelector('input[name="points"]').value;  // Get the points value
        const applicationId = form.querySelector('input[name="application_id"]').value;  // Get the application ID
        const pointsType = form.querySelector('input[name="points_type"]').value;  // Get the points type

        const formData = new FormData();
        formData.append('points', pointsValue);  // Append the points value to the form data
        formData.append('applicationId', applicationId);  // Append the application ID to the form data
        formData.append('pointsType', pointsType);  // Append the points type

        // Send the form data via Fetch API
        fetch('/admin/application/points/' + applicationId, {
            method: 'POST',
            body: formData
        })
        .then(response => response.json())  // Parse the JSON response from the server
        .then(data => {
            if (data.success) {
                $.notify(
                    {
                        icon: "fa fa-check me-1",
                        message: data.message,
                    },
                    {
                        type: "success",
                        allow_dismiss: false,
                    }
                );
            } else {
                $.notify(
                    {
                        icon: "fa fa-times-circle me-1",
                        message: data.message,
                    },
                    {
                        type: "danger",
                        allow_dismiss: false,
                    }
                );
            }
        })
        .catch(error => {
            $.notify(
                {
                    icon: "fa fa-times-circle me-1",
                    message: "An error occurred. Please try again.",
                },
                {
                    type: "danger",
                    allow_dismiss: false,
                }
            );
            console.error("Error:", error);
        });
    });
});


    </script>
        `)%>